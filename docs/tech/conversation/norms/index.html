<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/developer/blog/rss.xml" title="WeNet Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/developer/blog/atom.xml" title="WeNet Documentation Blog Atom Feed"><title data-react-helmet="true">Norms | WeNet Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://InternetOfUs.github.io/developer/docs/tech/conversation/norms"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Norms | WeNet Documentation"><meta data-react-helmet="true" name="description" content="A norm is a set of conditions that if they are satisfied provokes that has to do a set of actions,"><meta data-react-helmet="true" property="og:description" content="A norm is a set of conditions that if they are satisfied provokes that has to do a set of actions,"><link data-react-helmet="true" rel="shortcut icon" href="/developer/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://InternetOfUs.github.io/developer/docs/tech/conversation/norms"><link data-react-helmet="true" rel="alternate" href="https://InternetOfUs.github.io/developer/docs/tech/conversation/norms" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://InternetOfUs.github.io/developer/docs/tech/conversation/norms" hreflang="x-default"><link rel="stylesheet" href="/developer/assets/css/styles.fafa948e.css">
<link rel="preload" href="/developer/assets/js/runtime~main.d98cc188.js" as="script">
<link rel="preload" href="/developer/assets/js/main.b554da6f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/developer/"><img src="/developer/img/logo.jpg" alt="WeNet logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/developer/img/logo.jpg" alt="WeNet logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Docs</b></a><a class="navbar__item navbar__link" doc="pilot" href="/developer/docs/platform/intro">The Platform</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" doc="tech" href="/developer/docs/tech/conversation/models">Developer</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/InternetOfUs/developer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Conversation</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/developer/docs/tech/conversation/app-logic">App logic</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/developer/docs/tech/conversation/norms">Norms</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/developer/docs/tech/conversation/models">Models</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Use cases</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Open Calls</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Norms</h1></header><p>A norm is a set of conditions that if they are satisfied provokes that has to do a set of actions,
and with this mechanism is controlled the interactions in the WeNet platform. These interactions
are modelled as messages between WeNet users or between a component and a WeNet user. The component
that do this is the WeNet interaction protocol engine. This component is formed by a set of norm engines,
where each one is responsible to get the norms to evaluate from the point of view of a user and to do
the actions of the norms that will be satisfied. In other words, each user on the WeNet platform has
its norm engine to evaluate the actions that a user do or the notification that it can receive.
The norms are defined on the profile of the user, on the community that the user is, into the task
that the user is involved in and in the same message. The norm engine of each user decided with norms
has to be evaluated depending on the interaction and the status of the user. These norm engines are
in rest mode and when a message is received, they collect the necessary norms evaluate them and do
the actions of the norms that are satisfied. The messages that start a norm engine are associated
with one of the next actions:</p><ul><li><strong>Create a task</strong>: When a user wants to create a task.</li><li><strong>Do transaction</strong>: When a user wants to modify a task.</li><li><strong>Send Incentive</strong>: When the incentive server wants to send an incentive to a user.</li><li><strong>Received a message</strong>: When a norm engine receives a message from another norm engine.</li><li><strong>Received an event</strong>: When a norm engine notifies himself of an event.</li></ul><p>On the other hand, the norms are formed by a set of conditions that if they are satisfied execute
a set of actions associated with it. A grosso modo the conditions check the action that has started
the norm engine or the status of the user, and the actions can send a message to the user associated
with the norm engine or send a message to the norm engine of another user.</p><p>The norm engine is developed in <a href="https://www.swi-prolog.org/" target="_blank" rel="noopener noreferrer">SWI Prolog</a>, so this is the language
that is used to define the norms. The norm and action as defined as predicates. A predicate is like
a function that starts with a lower case letter followed by letters, numbers or the underscore
and after that between parenthesis are the arguments of the action or the condition separated
by commas. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly prolog"><pre tabindex="0" class="prism-code language-prolog codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">get_task_attribute_value(StartTime,&#x27;startTime&#x27;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The data model of a norm is defined in JSON, and it has the next fields:</p><ul><li><strong>whenever</strong> is used to define the conditions that have to satisfy to fire the actions.
Each condition can be separated by the conjunctions <strong>and</strong>, <strong>or</strong> or <strong>not</strong>.</li><li><strong>thenceforth</strong> is used to define the actions to do if the conditions are satisfied.
Each action is separated by the conjunction <strong>and</strong>.</li><li><strong>ontology</strong> is used to define new prolog predicates that can be used in any condition
or action of a norm. If the predicate can be used as an action you must define it as <strong>dynamic</strong>.</li></ul><p>The next example is the JSON representation of a norm to send an error to the user if try to create a task
with the start time less than or equals to now.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;whenever&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;is_received_created_task() and get_task_attribute_value(StartTime,startTime) and is_now_greater_than_or_equal_to(StartTime)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;thenceforth&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;close_task() and send_error(&#x27;cannot_create_task_with_bad_startTime&#x27;)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;ontology&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;:- dynamic send_error/1. send_error(Code) :- get_task_id(TaskId), send_user_message(&#x27;Error&#x27;,json([code=Code,taskId=TaskId])).&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>As you can see the arguments of the conditions or the actions can be a <strong>variable</strong> or a value. A variable starts
with an upper case letter followed by letters, numbers or the underscore. ATTENTION, the variables
only be associated with a value. In other words, when a variable is associated with a value, it can not be changed
in all the norm. So, if you want to change the value of a variable you must define a new variable. The values
as argument of the predicate or a value of a variable can be:</p><ul><li>A <strong>Boolean</strong> value that can be <code>true</code> or <code>false</code>.</li><li>A <strong>Number</strong> value that can represent any integer or floating-point number. For example: <code>-1.34</code> or <code>89</code></li><li>A <strong>String</strong> value is a sequence of any characters between single quotes (<code>&#x27;</code>) or a sequence of characters that
starts with a lower case followed by letters, numbers or the underscore. For example: <code>&#x27;String value&#x27;</code> or <code>id</code>.</li><li>An <strong>Array</strong> value is a list of values between quadratus and separated by commas. For example: <code>[&#x27;One&#x27;,2,[3,&#x27;three&#x27;]]</code></li><li>A <strong>Json</strong> value that is mapped as the predicate <code>json</code> and with an array as an argument where its elements
are pairs of field name and value separated by an equals. For example: <code>json([id=&#x27;1&#x27;,goal=json([name=&#x27;Eat together&#x27;])])</code>.
You can read more about the conversion from JSON to a predicate <a href="https://www.swi-prolog.org/pldoc/doc_for?object=json_read/2" target="_blank" rel="noopener noreferrer">here</a>.
Attention if the field name does not start with a lower case followed for letters, numbers or the underscore,
it must be written as a string between single quotes. For example: <code>json([&#x27;Action&#x27;=&#x27;Questions 1&#x27;,&#x27;Message&#x27;=&#x27;&#x27;])</code></li><li>An underscore (<code>_</code>) to mark that it accepts any value. In other words, that the value that matches
this position is ignored.</li></ul><p>As you have read before the norms are defined in different data models in the WeNet platform. The norms that affect
any interaction that a user is involved in are defined on the profile of the user. You can modify these norms by doing
an HTTP CRUD request over the WeNet profile manager. For the interaction that does any user in a community, the norms
are defined on the community profile. You can modify these norms by doing an HTTP CRUD request over the WeNet profile manager.
For modifying the logic that is involved in a task you must modify the norms defined on the task and its type using
HTTP CRUD requests over the task manager.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="protocol-actions"></a>Protocol actions<a class="hash-link" href="#protocol-actions" title="Direct link to heading">#</a></h2><p>Before you have read that the norm engine is activated for one of the five possible actions, now you can read more about
what happens when each of these actions happens.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="create-a-task"></a>Create a task<a class="hash-link" href="#create-a-task" title="Direct link to heading">#</a></h3><p>When a user wants to create a task to do interact with the user interface of the application. This converts this
into an HTTP request to the WeNet service component. This component checks the authentication and authorization
of the user that runs the application. If it is valid the service component calls the WeNet task manager with the task
to create. This component checks that the new task is valid and if it is then the task is stored and finally it calls
the WeNet interaction protocol engine to inform that a task is created. This last one gets the norms of the user that
create the task, the norms of the community where is defined the task, the norms of the task type associated with the task,
and the norms of the task, and start a new norm engine to validate this tasks. From this point what happens depends
on the fired norms and their associated actions. But normally what happens is that will be fired a set of norms that decide
which of the WeNet users will collaborate to do the created task. These actions normally send a message to each norm engine
of the selected users. Then each norm engine collects the norms of the user, the community, the task type, and the task
and decides the message to send to the user. When is decided this message is posted as an HTTP to the message callback
of the application where the task is created. An then the user interface of the application show that it is selected
to participate in the task.</p><p>The task validation by the WeNet task manager consists of verifying:</p><ul><li>If an identifier is set that is not already defined and it has less than 255 characters. If it is not set
the task manager will set a unique identifier to the task.</li><li>That it has a task type, that this type exists and that the attributes of the task follow the possible attributes
defined on the type.</li><li>That the user that wants to create the task (requester) has a profile on the WeNet platform.</li><li>That the application associated with the task exists.</li><li>That the community associated with the task exists, or if it is not set it assigns the default community
of the application where the task is added.</li><li>That the user defines the name of the goal. It can not be larger than 255 characters. If you want to write something
larger you can add this extra information on the goal description that its maximum is 1023 characters.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="do-a-task-transaction"></a>Do a task transaction<a class="hash-link" href="#do-a-task-transaction" title="Direct link to heading">#</a></h3><p>When a user wants to interact in a task it has to do a task transaction. This begins with an interaction on the user
interface of the application, that is converted into an HTTP request to the WeNet service component. This component
checks the authentication and authorization of the user that runs the application. If it is valid the service component
calls the WeNet task manager with the transaction to do. This component checks that the transaction is valid and if it is
calls the WeNet interaction protocol engine to inform about the transaction to do. This last one gets the norms of the user
that do the transaction, the norms of the community of the task, the norms of the task type associated with the task,
and the norms of the task and start a new norm engine to validate this transaction. From this point what happens depends
on the fired norms and their associated actions. But normally what happens is that will be fired a set of norms that
changes the state of the user or the task and notify of these changes to the norm engines of the other users that
participate in the task. The notified norm engines get again the norms by with the norms of the user that represents
and as result send a callback message to the user, that will be converted into an event on the user interface of the user
application.</p><p>The task transaction validation by the WeNet task manager consists of verifying:</p><ul><li>That the task associated with the transaction is defined.</li><li>That the agent that does the transaction has a profile on the WeNet platform.</li><li>That the label and attributes of the transaction match any of the possibles defined by the task type associated
with the task of the transaction.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="send-an-incentive"></a>Send an incentive<a class="hash-link" href="#send-an-incentive" title="Direct link to heading">#</a></h3><p>When the WeNet incentive server wants to send an incentive to a user it posted an HTTP request to the WeNet interaction
protocol engine with the incentive to send to the user. This component validates the incentive and if it is valid gets
the norms of the user and the norms of the community of the application with in the incentive. And after that
start the norm engine to decide what to do next depending on the norms that will be fired. Normally this norms
converts the incentive into a callback message that is sent to the application of the user, which converts the message
into an event on the user interface of the user.</p><p>The incentive validation by the WeNet interaction protocol engine consists of verifying:</p><ul><li>That the task associated with the transaction is defined.</li><li>That the agent that does the transaction has a profile on the WeNet platform.</li><li>That the label and attributes of the transaction match any of the possibles defined by the task type associated
with the task of the transaction.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="received-message"></a>Received message<a class="hash-link" href="#received-message" title="Direct link to heading">#</a></h3><p>When a norm engine wants to notify the norm engine of another user it posted an HTTP request to the WeNet interaction
protocol engine, which validates the message and passes it through to the norm engine of the user. It obtains the norms
associated with the message and validates them to known with actions to do next, as you can read on the previous actions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="received-event"></a>Received event<a class="hash-link" href="#received-event" title="Direct link to heading">#</a></h3><p>An event is a message that a norm engine is sent to itself after a delay in seconds. It is used to activate the norm
engine and evaluate again the norms. For example: imagine a task that you want to close after a day, then you may define a
norm that when the task is created send an event to be delivered after a day, and another norm to close the task when
this event is received.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="conditions"></a>Conditions<a class="hash-link" href="#conditions" title="Direct link to heading">#</a></h2><p>The norms are formed by a list of conditions separated by the conjunctions <code>and</code> or <code>or</code>, or negated using
the predicate <code>not(Condition)</code>. You can use any predicate defined by the <a href="https://www.swi-prolog.org/" target="_blank" rel="noopener noreferrer">SWI Prolog</a>.
The next sections show the most common conditions that have been provided to help to the norm definition.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="message-conditions"></a>Message conditions<a class="hash-link" href="#message-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to check the protocol message that has started the norm engine.</p><ul><li><code>is_received_created_task()</code>
This condition is <strong>true</strong> when the message informs that a task is created.</li><li><code>is_received_do_transaction(Label,Attributes)</code>
This condition is <strong>true</strong> when the message informs that a user wants to do a transaction.<ul><li><code>Label</code>  <em>Output</em>  string with the transaction label.</li><li><code>Attributes</code>  <em>Output</em>  JSON model with the transaction attributes.</li></ul></li><li><code>is_received_send_incentive(Incentive)</code>
This condition is <strong>true</strong> when the message is sent by the incentive server to notify a user.<ul><li><code>Incentive</code>  <em>Output</em>  JSON model with the incentive to notify to the user.</li></ul></li><li><code>is_received(SenderId,Particle,Content)</code>
This condition is <strong>true</strong> when the message is from another norm engine.<ul><li><code>SenderId</code>  <em>Output</em>  string with the user identifier that has sent the message.</li><li><code>Particle</code>  <em>Output</em>  string with the message particle.</li><li><code>Content</code> <em>Output</em>  JSON model with the message content.</li></ul></li><li><code>is_received_event(Particle,Content)</code>
This condition is <strong>true</strong> when the received message is an event.<ul><li><code>Particle</code>  <em>Output</em>  string with the event particle.</li><li><code>Content</code> <em>Output</em>  JSON model with the event content.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="users-conditions"></a>Users conditions<a class="hash-link" href="#users-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to manage the users that can be involved in a task. On this condition <strong>me</strong> refers
to the user of the norm engine that has been started.</p><ul><li><code>get_app_users(Users)</code>
This condition is used to obtain the users that are on the application.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of the users that are in the application.</li></ul></li><li><code>get_app_users_except_me(Users)</code>
This condition is used to obtain the users that are on the application removing the identifier of the user
associated with the norm engine.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of the users.</li></ul></li><li><code>get_closest_users_to_me(Users)</code>
This condition is used to obtain the users, maximum 10, that are closest to the user associated
to the norm engine.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of the users.</li></ul></li><li><code>get_closest_users_to_me(Users,NumUsers)</code>
This condition is used to obtain the users that are closest to the user associated with the norm engine.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of the users.</li><li><code>NumUsers</code>  <em>Input</em>  number maximum of users to return.</li></ul></li><li><code>get_app_users_near_me(Users,Min,Max)</code>
This condition is used to obtain the users on the application that are in a range to the user associated with
the norm engine. Thus, it returns the application users that are in a distance <strong>[Min, Max]</strong> to me.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of the users.</li><li><code>Min</code>  <em>Input</em>  number the minimum distance in meters to the user associated with the norm engine.</li><li><code>Max</code>  <em>Input</em>  number the maximum distance in meters to the user associated with the norm engine.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="me-conditions"></a>Me conditions<a class="hash-link" href="#me-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are over the user associated with the norm engine (<strong>me</strong>).</p><ul><li><code>get_profile_id(Me)</code>
This condition is used to obtain the identifier to the user associated with the norm engine.<ul><li><code>Me</code>  <em>Output</em>  string with the identifier of the user.</li></ul></li><li><code>get_profile(Profile)</code>
This condition is used to obtain the profile of the user associated with the norm engine at the moment it is started.<ul><li><code>Profile</code>  <em>Output</em>   JSON model with the profile.</li></ul></li><li><code>get_user_state(State)</code>
This condition obtains the state of the user. This state is shared by all the norm engines
associated with <strong>me</strong>.<ul><li><code>State</code>  <em>Output</em>  JSON model with the user state.</li></ul></li><li><code>get_user_state_attribute(Value,Key)</code>
This condition obtains the value of a user state attribute. If it is not defined this predicate fails.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li></ul></li><li><code>get_user_state_attribute(Value,Key,DefaultValue)</code>
This condition obtains the value of a user state attribute, or a default value if it is not defined.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute or the default one if it is not defined.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li><li><code>DefaultValue</code>  <em>Input</em>  value to return if the attribute is not defined.</li></ul></li><li><code>get_relationships(Relationships)</code>
This condition obtains the best 1k social network relationships of the current user repect
the other application users. value of a user state attribute, or a default value if it is not defined.<ul><li><code>Relationships</code>  <em>Output</em>  array of JSON models with my social network relationships.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="application-conditions"></a>Application conditions<a class="hash-link" href="#application-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are over the application associated with the norm engine.</p><ul><li><code>get_app_id(AppId)</code>
This condition is used to obtain the identifier to the application associated with the norm engine.<ul><li><code>AppId</code>  <em>Output</em>  string with the identifier of the application.</li></ul></li><li><code>get_app(App)</code>
This condition obtains the model data of the application associated with the norm engine. The data model
is obtained the first time this condition is called, after that the value is fixed.<ul><li><code>App</code>  <em>Output</em>  JSON model with the application data.</li></ul></li><li><code>get_app_message_callback_url(Url)</code>
This condition obtains the URL to post the messages to send to the user into the application
associated with the norm engine. The URL is obtained the first time this condition is called, after that
the value is fixed.<ul><li><code>Url</code>  <em>Output</em>  string to the URL to post the callback messages.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="community-conditions"></a>Community conditions<a class="hash-link" href="#community-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are over the community associated with the norm engine.</p><ul><li><code>get_community_id(CommunityId)</code>
This condition is used to obtain the identifier to the community associated with the norm engine.<ul><li><code>CommunityId</code>  <em>Output</em>  string with the identifier of the community.</li></ul></li><li><code>get_community(Community)</code>
This condition obtains the model data of the community associated with the norm engine. The data model
is obtained the first time this condition is called, after that the value is fixed.<ul><li><code>Community</code>  <em>Output</em>  JSON model with the community data.</li></ul></li><li><code>get_community_state(State)</code>
This condition obtains the state of the user in the community associated with the norm engine.
This state is shared by all the norm engines associated with the user for the same community.<ul><li><code>State</code>  <em>Output</em>  JSON model with the community user state.</li></ul></li><li><code>get_community_state_attribute(Value,Key)</code>
This condition obtains the value of a community user state attribute. If it is not defined this predicate fails.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li></ul></li><li><code>get_community_state_attribute(Value,Key,DefaultValue)</code>
This condition obtains the value of a community user state attribute, or a default value if it is not defined.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute or the default one if it is not defined.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li><li><code>DefaultValue</code>  <em>Input</em>  value to return if the attribute is not defined.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="task-conditions"></a>Task conditions<a class="hash-link" href="#task-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are over the task associated with the norm engine.</p><ul><li><code>get_task_id(TaskId)</code>
This condition is used to obtain the identifier to the task associated with the norm engine.<ul><li><code>TaskId</code>  <em>Output</em>  string with the identifier of the task.</li></ul></li><li><code>get_task(Task)</code>
This condition is used to obtain the task associated with the norm engine at the moment it is started.<ul><li><code>Task</code>  <em>Output</em>   JSON model with the task.</li></ul></li><li><code>get_task_requester_id(RequesterId)</code>
This condition obtains the requester identifier of the task associated with the norm engine.<ul><li><code>RequesterId</code>  <em>Output</em>  string with the task requester identifier.</li></ul></li><li><code>get_task_goal_name(Name)</code>
This condition obtains the goal name of the task associated with the norm engine.<ul><li><code>Name</code>  <em>Output</em>  string with the task goal name.</li></ul></li><li><code>is_task_closed()</code>
This condition is <strong>true</strong> when the task associated with the norm engine is closed.</li><li><code>get_task_attribute_value(Value,Key)</code>
This condition obtains the value of a task attribute. If it is not defined this predicate fails.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li></ul></li><li><code>get_task_state(State)</code>
This condition obtains the state of the user in the task associated with the norm engine.
This state is shared by all the norm engines associated with the user for the same task.<ul><li><code>State</code>  <em>Output</em>  JSON model with the task user state.</li></ul></li><li><code>get_task_state_attribute(Value,Key)</code>
This condition obtains the value of a task user state attribute. If it is not defined this predicate fails.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li></ul></li><li><code>get_task_state_attribute(Value,Key,DefaultValue)</code>
This condition obtains the value of a task user state attribute, or a default value if it is not defined.<ul><li><code>Value</code>  <em>Output</em>  value associated with the attribute or the default one if it is not defined.</li><li><code>Key</code>  <em>Input</em>  string with the name of the attribute.</li><li><code>DefaultValue</code>  <em>Input</em>  value to return if the attribute is not defined.</li></ul></li><li><code>get_task_type_id(TaskTypeId)</code>
This condition obtains the type identifier for the task associated with the task of the norm engine.<ul><li><code>TaskTypeId</code>  <em>Output</em>   string with the task type identifier.</li></ul></li><li><code>get_task_type(TaskType)</code>
This condition is used to obtain the type of task associated with the norm engine at the moment it is started.<ul><li><code>TaskType</code>  <em>Output</em>   JSON model with the task type.</li></ul></li><li><code>get_transaction_id(TransactionId)</code>
This condition is used to obtain the identifier of the transaction associated with the norm engine or the identifier
of the last transaction added to the task associated with the norm engine.<ul><li><code>TransactionId</code>  <em>Output</em>  string transaction identifier.</li></ul></li><li><code>get_transaction(Transaction)</code>
This condition is used to obtain the task transaction associated with the norm engine at the moment it is started,
or return the last transaction added to the task associated with the norm engine.<ul><li><code>Task</code>  <em>Output</em>   JSON model with the task.</li></ul></li><li><code>get_transaction(Transaction,TransactionId)</code>
This condition is used to obtain the task transaction defined into the task associated with the norm engine.<ul><li><code>Transaction</code>  <em>Output</em>  JSON model with the transaction</li><li><code>TransactionId</code>  <em>Input</em>  string identifier of the task transaction to obtain.</li></ul></li><li><code>filter_transactions(Result,Test,Map)</code>
This condition is used to obtain a sub set of the transactions that has been done in the task
and map them to a new value. In other words, for each transaction of the current task if
<code>call(Test,Transaction)</code> is True, it transforms the transaction with <code>call(Map,Value,Transaction)</code>
and it adds the obtained Value to the result list.<ul><li><code>Result</code>  <em>Output</em>  anything the filtered and mapped task transactions.</li><li><code>Test</code>  <em>Input</em>  predicate to call to known if the transaction is accepted.</li><li><code>Map</code>  <em>Input</em>  predicate to call to convert the accepted transaction.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="social-context-builder-conditions"></a>Social context builder conditions<a class="hash-link" href="#social-context-builder-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to interact with the social context builder.</p><ul><li><code>get_social_explanation(Explanation,UserId)</code>
This condition obtains the explanation of why a user has to be chosen to be a volunteer.<ul><li><code>Explanation</code>  <em>Output</em>  JSON model with the explanation provided by the social context builder.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to obtain the explanation.</li></ul></li><li><code>normalized_social_closeness(Socialness,Users)</code>
Calculate the socialness of the current users respects some others.<ul><li><code>Socialness</code>  <em>Output</em>  JSON model list with the userId and value on the range [0,1] with the social closeness.</li><li><code>Users</code>  <em>Input</em>  string list with the identifiers of the users to calculate the social closeness respect the current user.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="personal-context-builder-conditions"></a>Personal context builder conditions<a class="hash-link" href="#personal-context-builder-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to interact with the personal context builder</p><ul><li><code>normalized_closeness(Closeness,Users,MaxDistance)</code>
Calculate the closeness (in distance) of the current user to some others.<ul><li><code>Closeness</code>  <em>Output</em>  JSON model list with the userId and value on the range [0,1] with the close in distance to the user. Where 1 is at the same location and on the 0 is too far away.</li><li><code>Users</code>  <em>Input</em>  string list with the identifiers of the users to calculate the closeness respect the current user.</li><li><code>MaxDistance</code>  <em>Input</em>  number  the maximum distance that a user can be.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="diversity-conditions"></a>Diversity conditions<a class="hash-link" href="#diversity-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to manage the diversity of some users.</p><ul><li><code>normalized_diversity(Diversity,Users,Attributes)</code>
Calculate the diversity of the current user over some other users.<ul><li><code>Diversity</code>  <em>Output</em>  JSON model list with the userId and value on the range [0,1] with the diversity of the user. Where 1 is the maximum diversity and 0 that the user is similar to.</li><li><code>Users</code>  <em>Input</em>  string list with the identifiers of the users to calculate the diversity respect the current user.</li><li><code>Attributes</code>  <em>Input</em>  string list  with the names of the attributes of the profile to calculate the diversity.</li></ul></li><li><code>my_profile_attributes_similars_to(Attributes,Text,MinSimilarity)</code>
Obtain the attributes of my profile that has a similarity to a text equal or greater than the minimum.<ul><li><code>Attributes</code>  <em>Output</em>  string list  with the name of the profile attributes that are similar to the text.</li><li><code>Text</code>  <em>Input</em>  string  to compare the profile attributes.</li><li><code>MinSimilarity</code>  <em>Input</em>  number  a value in the range [0,1] that define the minimum similarity to take an attribute.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="time-conditions"></a>Time conditions<a class="hash-link" href="#time-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are over the constant <strong>now</strong>, that it is the difference, measured in seconds,
between the time the norm engine is started and midnight, January 1, 1970, UTC.</p><ul><li><code>is_now_less_than(Time)</code>
This condition is <strong>true</strong> when <strong>now</strong> is less than a value.<ul><li><code>Time</code>  <em>Input</em>  integer time in seconds to check.</li></ul></li><li><code>is_now_less_than_or_equal_to(Time)</code>
This condition is <strong>true</strong> when <strong>now</strong> is less than or equal to a value.<ul><li><code>Time</code>  <em>Input</em>  integer time in seconds to check.</li></ul></li><li><code>is_now_greater_than(Time)</code>
This condition is <strong>true</strong> when <strong>now</strong> is greater than a value.<ul><li><code>Time</code>  <em>Input</em>  integer time in seconds to check.</li></ul></li><li><code>is_now_greater_than_or_equal_to(Time)</code>
This condition is <strong>true</strong> when <strong>now</strong> is greater than or equal to a value.<ul><li><code>Time</code>  <em>Input</em>  integer time in seconds to check.</li></ul></li><li><code>is_now_equal_to(Time)</code>
This condition is <strong>true</strong> when <strong>now</strong> is equal to a value.<ul><li><code>Time</code>  <em>Input</em>  integer time in seconds to check.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="json-conditions"></a>JSON conditions<a class="hash-link" href="#json-conditions" title="Direct link to heading">#</a></h3><p>The next conditions are used to manage JSON models.</p><ul><li><code>get_attribute(Value,Key,Json)</code>
This condition obtains an attribute (field) of a JSON model. If the attribute is not defined
this condition fails.<ul><li><code>Value</code>  <em>Output</em>  value of the attribute.</li><li><code>Key</code>  <em>Input</em>  string name of the attribute.</li><li><code>Json</code>  <em>Input</em>  JSON model to obtain the attribute.</li></ul></li><li><code>get_attribute(Value,Key,DefaultValue,Json)</code>
This condition obtains an attribute (field) of a JSON model. If the attribute is not defined
it returns the default value.<ul><li><code>Value</code>  <em>Output</em>  value of the attribute or the default value is not defined.</li><li><code>Key</code>  <em>Input</em>  string name of the attribute.</li><li><code>DefaultValue</code>  <em>Input</em>  value to return if it is not defined.</li><li><code>Json</code>  <em>Input</em>  JSON model to obtain the attribute.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="actions"></a>Actions<a class="hash-link" href="#actions" title="Direct link to heading">#</a></h2><p>The norms to do when the conditions of a norm are predicates separated by the conjunction <code>and</code>. You can use
any predicate defined by the <a href="https://www.swi-prolog.org/" target="_blank" rel="noopener noreferrer">SWI Prolog</a>, but before you have to mark it as <code>dynamic</code>
on the ontology of the norm. The next sections show the most common actions that have been provided to help
to the norm definition.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="user-actions"></a>User actions<a class="hash-link" href="#user-actions" title="Direct link to heading">#</a></h3><p>These actions are done over the user that is associated with the norm engine, thus the receiver user of the message.</p><ul><li><code>send_user_message(Label,Content)</code>
This action posts a callback message to the user.
If it is done over an active transaction it is stored in it and notify
the incentive server and the social context builder that the message is sent.<ul><li><code>Label</code> <em>Input</em>  string with the message label.</li><li><code>Content</code> <em>Input</em>  JSON model with the message content.</li></ul></li><li><code>merge_user_state(State)</code>
This action merges the current state of the user.<ul><li><code>State</code>  <em>Input</em>  JSON model with the new state of the user.</li></ul></li><li><code>put_user_state_attribute(Key,Value)</code>
This action changes an attribute of the state of the user.<ul><li><code>Key</code>  <em>Input</em>  string with the name of the state attribute.</li><li><code>Value</code>  <em>Input</em>  value to put to the attribute of the state.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="community-actions"></a>Community actions<a class="hash-link" href="#community-actions" title="Direct link to heading">#</a></h3><p>These actions are done over the community that is associated with the received message.</p><ul><li><code>merge_community_state(State)</code>
This action merges the current state of the user for the community.<ul><li><code>State</code>  <em>Input</em>  JSON model with the new state of the user on the community.</li></ul></li><li><code>put_community_state_attribute(Key,Value)</code>
This action changes an attribute of the state of the user for the community.<ul><li><code>Key</code>  <em>Input</em>  string with the name of the state attribute.</li><li><code>Value</code>  <em>Input</em>  value to put to the attribute of the state.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="task-actions"></a>Task actions<a class="hash-link" href="#task-actions" title="Direct link to heading">#</a></h3><p>These actions are done in the task that is associated with the received message.</p><ul><li><code>add_created_transaction()</code>
This action adds a new transaction to the task that represents that the creation
of the task.
It also notifies the incentive server that the task is created.</li><li><code>add_message_transaction()</code>
This action adds the transaction defined on the received message into the task.
It also notifies the incentive server that the transaction is done.</li><li><code>put_task_attribute(Key,Value)</code>
This action changes an attribute of the current task model.<ul><li><code>Key</code>  <em>Input</em>  string with the name of the task attribute.</li><li><code>Value</code>  <em>Input</em>  value to put to the task attribute.</li></ul></li><li><code>merge_task(Task)</code>
This action modifies the current task model.<ul><li><code>Task</code>  <em>Input</em>  JSON model with the new values for the task.</li></ul></li><li><code>close_task()</code>
This action marks the task associated with the norm engine as closed.</li><li><code>merge_task_state(State)</code>
This action merges the current state of the user for the task.<ul><li><code>State</code>  <em>Input</em>  JSON model with the new state of the user on the task.</li></ul></li><li><code>put_task_state_attribute(Key,Value)</code>
This action changes an attribute of the state of the user for the task.<ul><li><code>Key</code>  <em>Input</em>  string with the name of the state attribute.</li><li><code>Value</code>  <em>Input</em>  value to put to the attribute of the state.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="interact-with-wenet-components"></a>Interact with WeNet components<a class="hash-link" href="#interact-with-wenet-components" title="Direct link to heading">#</a></h3><p>These actions interact with the other components of the WeNet platform.</p><ul><li><code>send_messages(Users,Particle,Content)</code>
This action sends messages to the norm engines of some users.<ul><li><code>Users</code>  <em>Input</em>  array of strings of the users to receive a message.</li><li><code>Particle</code>  <em>Input</em>  string with the message particle.</li><li><code>Content</code>  <em>Input</em>  JSON model with the message content.</li></ul></li><li><code>send_message(UserId,Particle,Content)</code>
This action sends a message to the norm engines of a user.<ul><li><code>UserId</code>  <em>Input</em>  strings identifier of the user to receive the message.</li><li><code>Particle</code>  <em>Input</em>  string with the message particle.</li><li><code>Content</code>  <em>Input</em>  JSON model with the message content.</li></ul></li><li><code>notify_incentive_server_task_created()</code>
This action notifies the incentive server that a user has created a task.
The number of times the task is created is counted by the user, task type and community.</li><li><code>notify_incentive_server_transaction_done(Label)</code>
This action notifies the incentive server that a task transaction is done.
The number of times the transaction is done is counted by the user, task type and community.<ul><li><code>Label</code>  <em>Input</em>  string with the label of the transaction that has been done.</li></ul></li><li><code>notify_incentive_server_transaction_done(Label,Count)</code>
This action notifies the incentive server that a task transaction is done Count times in the community.<ul><li><code>Label</code>  <em>Input</em>  string with the label of the transaction that has been done.</li><li><code>Count</code>  <em>Input</em>  integer the number of times the user has done the transaction on the community for the current task type.</li></ul></li><li><code>notify_incentive_server_message_sent(Label)</code>
This action notifies the incentive server that a message is sent to the user.
The number of times the message is sent to the user is counted by the user, task type and community.<ul><li><code>Label</code>  <em>Input</em>  string with the label of the sent message.</li></ul></li><li><code>notify_incentive_server_transaction_done(Label,Count)</code>
This action notifies the incentive server that a message is sent to the user Count times in the community.<ul><li><code>Label</code>  <em>Input</em>  string with the label of the sent message.</li><li><code>Count</code>  <em>Input</em>  integer the number of times the message is sent to the user on the community for the current task type.</li></ul></li><li><code>volunteers_ranking(Ranking,Volunteers)</code>
This action calls the social context builder to obtain a ranking for some volunteers.<ul><li><code>Ranking</code>  <em>Output</em>  array of strings with the ranked volunteers.</li><li><code>Volunteers</code>  <em>Input</em>  array of strings with the user identifiers that has volunteer.</li></ul></li><li><code>answers_ranking(Ranking,UserAnswers)</code>
This action calls the social context builder to obtain a ranking for some answers.<ul><li><code>Ranking</code>  <em>Output</em>  array of strings with the ranked answers.</li><li><code>UserAnswers</code>  <em>Input</em>  array of JSON models with the user answers. This array elements
can be created using the <code>wenet_new_user_answer</code>.</li></ul></li><li><code>selected_answer_from_last_ranking(UserAnswer)</code>
This action notify the social context builder the selected answers of the last answer ranking result.<ul><li><code>UserAnswers</code>  <em>Input</em>  JSON models with the selected user answer.</li></ul></li><li><code>notify_social_context_builder_message_sent(Message)</code>
This action notifies the social context builder that a message is sent to the user.<ul><li><code>Message</code>  <em>Input</em>  JSON model with the sent message.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="other-useful-norms-predicates"></a>Other Useful Norms predicates<a class="hash-link" href="#other-useful-norms-predicates" title="Direct link to heading">#</a></h2><p>We provide other predicates that can be used to help to define the conditions and the actions of any norm.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="facts"></a>Facts<a class="hash-link" href="#facts" title="Direct link to heading">#</a></h3><p>The next predicates refer to facts (constants) that have been set when the norm engine has been started.</p><ul><li><code>get_message(Message)</code>
The fact with the received message that has started the norm engine.<ul><li><code>Message</code>  <em>Output</em>  JSON model of the received protocol message.</li></ul></li><li><code>get_now(Time)</code>
The fact with the difference, measured in seconds, between the time the norm engine is started and
midnight, January 1, 1970, UTC.<ul><li><code>Time</code>  <em>Output</em>  number with the started time in seconds.</li></ul></li><li><code>wenet_profile_manager_api_url(URL)</code>
The fact with the URL to the profile manager component.<ul><li><code>URL</code>  <em>Output</em>  string with the profile manager API URL.</li></ul></li><li><code>wenet_task_manager_api_url(URL)</code>
The fact with the URL to the task manager component.<ul><li><code>URL</code>  <em>Output</em>  string with the task manager API URL.</li></ul></li><li><code>wenet_interaction_protocol_engine_api_url(URL)</code>
The fact with the URL to the interaction protocol engine component.<ul><li><code>URL</code>  <em>Output</em>  string with the tinteraction protocol engine API URL.</li></ul></li><li><code>wenet_social_context_builder_api_url(URL)</code>
The fact with the URL to the social context builder component.<ul><li><code>URL</code>  <em>Output</em>  string with the social context builder API URL.</li></ul></li><li><code>wenet_service_api_url(URL)</code>
The fact with the URL to the service component.<ul><li><code>URL</code>  <em>Output</em>  string with the service API URL.</li></ul></li><li><code>wenet_incentive_server_api_url(URL)</code>
The fact with the URL to the incentive server component.<ul><li><code>URL</code>  <em>Output</em>  string with the incentive server API URL.</li></ul></li><li><code>wenet_personal_context_builder_api_url(URL)</code>
The fact with the URL to the personal context builder component.<ul><li><code>URL</code>  <em>Output</em>  string with the personal context builder API URL.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="user-value-models"></a>User value models<a class="hash-link" href="#user-value-models" title="Direct link to heading">#</a></h3><p>The next predicates are used to manipulate the JSON user-value models.</p><ul><li><code>wenet_new_user_value(UserValue,UserId,Value)</code>
Create a new user value JSON model.<ul><li><code>UserValue</code>  <em>Output</em>  JSON  user-value model.</li><li><code>UserId</code>  <em>Input</em>  string  identifier of the user.</li><li><code>Value</code>  <em>Input</em>  number  on the range [0,1] with the vlaue associated to the user.</li></ul></li><li><code>wenet_user_id_from_user_value(UserId,UserValue)</code>
Get the user identifier of the JSON user value model.<ul><li><code>UserId</code>  <em>Output</em>  string  with the user identifier defined on the model.</li><li><code>UserValue</code>  <em>Input</em>  JSON  user-value model.</li></ul></li><li><code>wenet_value_from_user_value(Value,UserValue)</code>
Get the value of the JSON user value model.<ul><li><code>Value</code>  <em>Output</em>  number  with the value defined on the model.</li><li><code>UserValue</code>  <em>Input</em>  JSON  user-value model.</li></ul></li><li><code>wenet_initialize_user_values(List,Users,Value)</code>
Create a list of user values for some users with the same value.<ul><li><code>List</code>  <em>Output</em>  JSON list  with the user-value models.</li><li><code>Users</code>  <em>Input</em>  string list  with the user identfifiers to create the models.</li><li><code>Value</code>  <em>Input</em>  number  on  the range [0,1] with the value to set for all the models.</li></ul></li><li><code>wenet_negate_user_value(Target,Source)</code>
Apply for each model-value model the operation 1 - Value.<ul><li><code>Target</code>  <em>Output</em>  JSON list with the user-value models where each value is negated (1 - value).</li><li><code>Source</code>  <em>Input</em>  JSON list  with the user-value models to negate their value.</li></ul></li><li><code>wenet_user_values_to_value_user_id_pairs(Target,Source)</code>
Convert a list of JSON user values to a list of pairs. A pair is UserId-Value.<ul><li><code>Target</code>  <em>Output</em>  strig list with the pairs.</li><li><code>Source</code>  <em>Input</em>  JSON list  with the user-value models to convert.</li></ul></li><li><code>wenet_value_user_id_pairs_to_user_values(Target,Source)</code>
Convert a list of pairs to a list of JSON user values. A pair is UserId-Value.<ul><li><code>Target</code>  <em>Output</em>  JSON list with the user-value models.</li><li><code>Source</code>  <em>Input</em>  string list  with the pairs  to convert.</li></ul></li><li><code>wenet_sort_user_values_by_value(Target,Source)</code>
Sort a list user values.<ul><li><code>Target</code>  <em>Output</em>  JSON list that is sorted by the value.</li><li><code>Source</code>  <em>Input</em>  JSON list of the user-value models to sort.</li></ul></li><li><code>wenet_user_values_to_user_ids(Target,Source)</code>
Convert a list of user values to a list of user identifiers.<ul><li><code>Target</code>  <em>Output</em>  JSON list that is sorted by the value.</li><li><code>Source</code>  <em>Input</em>  JSON list of the user-value models to sort.</li></ul></li><li><code>wenet_product_user_values(Product,A,B)</code>
Do the product of the value of the same user in both lists. If a user is present on A and not preset on B the product is 0. If a user is present on B and not preset on A it is ignored.<ul><li><code>Product</code>  <em>Output</em>  JSON list  with the product of the value of the same user identifier.</li><li><code>A</code>  <em>Input</em>  JSON list  with the user-value models to multiplicate.</li><li><code>B</code>  <em>Input</em>  JSON list  with the user-value models to multiplicate.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="logs-messages"></a>Logs messages<a class="hash-link" href="#logs-messages" title="Direct link to heading">#</a></h3><p>The next predicates are used to add messages to the logging files of the norm engine.</p><ul><li><code>wenet_log_trace(Text)</code>
This predicate adds a message to the trace log.<ul><li><code>Text</code>  <em>Input</em>  string with the trace log message.</li></ul></li><li><code>wenet_log_trace(Text,Terms)</code>
This predicate adds a message to the trace log with values.<ul><li><code>Text</code>  <em>Input</em>  string with the trace log message.</li><li><code>Terms</code> <em>Input</em> value to append to the end of the message.</li></ul></li><li><code>wenet_log_error(Text)</code>
This predicate adds a message to the error log.<ul><li><code>Text</code>  <em>Input</em>  string with the error log message.</li></ul></li><li><code>wenet_log_error(Text,Terms)</code>
This predicate adds a message to the error log with values.<ul><li><code>Text</code>  <em>Input</em>  string with the error log message.</li><li><code>Terms</code> <em>Input</em> value to append to the end of the message.</li></ul></li><li><code>wenet_log_error(Text,Terms,Error)</code>
This predicate adds a message to the error log with an exception.<ul><li><code>Text</code>  <em>Input</em>  string with the error log message.</li><li><code>Terms</code> <em>Input</em> value to append to the end of the message.</li><li><code>Error</code> <em>Input</em> exception to append to the end of the message.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="http-interaction"></a>HTTP interaction<a class="hash-link" href="#http-interaction" title="Direct link to heading">#</a></h3><p>The next predicates are used to do HTTP request into an URL.</p><ul><li><code>wenet_get_json_from_url(Json,Url)</code>
Get a model from an URL.<ul><li><code>Json</code>  <em>Output</em>  JSOM model of the received model.</li><li><code>Url</code>  <em>Input</em>  string with the URL to get the model.</li></ul></li><li><code>wenet_post_json_to_url(Json, Url, Body)</code>
Post a model into an URL.<ul><li><code>Json</code>  <em>Output</em>  JSOM model of the posted model.</li><li><code>Url</code>  <em>Input</em>  string with the URL to post the model.</li><li><code>Body</code>  <em>Input</em>  JSON model with the model to post.</li></ul></li><li><code>wenet_put_json_to_url(Json, Url, Body)</code>
Put a model into an URL.<ul><li><code>Json</code>  <em>Output</em>  JSOM model of the puted model.</li><li><code>Url</code>  <em>Input</em>  string with the URL to put the model.</li><li><code>Body</code>  <em>Input</em>  JSON model with the model to put.</li></ul></li><li><code>wenet_patch_json_to_url(Json, Url, Body)</code>
Patch a model into an URL.<ul><li><code>Json</code>  <em>Output</em>  JSOM model of the patched model.</li><li><code>Url</code>  <em>Input</em>  string with the URL to patch the model.</li><li><code>Body</code>  <em>Input</em>  JSON model with the model to patch.</li></ul></li><li><code>wenet_delete_to_url(Url)</code>
Delete a model from an URL.<ul><li><code>Url</code>  <em>Input</em>  string with the URL to delete the model.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="utils"></a>Utils<a class="hash-link" href="#utils" title="Direct link to heading">#</a></h3><ul><li><code>wenet_remove(Result,Element,List)</code>
This predicate removes an element from an array.<ul><li><code>Result</code>  <em>Output</em>  array of values without the element.</li><li><code>Element</code>  <em>Input</em>  value to remove.</li><li><code>List</code>  <em>Input</em>  array of values to remove the element.</li></ul></li><li><code>wenet_add(Result,Element,List)</code>
This predicate adds an element to the end of an array.<ul><li><code>Result</code>  <em>Output</em>  array of values where the element is added.</li><li><code>Element</code>  <em>Input</em>  value to add.</li><li><code>List</code>  <em>Input</em>  array of values to add the element.</li></ul></li><li><code>wenet_format(Msg,WeNetFormat,Arguments)</code>
This predicate is used to create an string from a pattern. For the pattern <strong>{}</strong> are replaced with
the argument on the same position. For example: <code>wenet_format(&#x27;Value One and 2&#x27;,&#x27;Value {} and {}&#x27;,[&#x27;One&#x27;,2])</code><ul><li><code>Msg</code>  <em>Output</em>  string where are replaced the values of the pattern.</li><li><code>WeNetFormat</code>  <em>Input</em>  string with the pattern to replace <strong>{}</strong> with values.</li><li><code>Arguments</code> <em>Input</em>  array of values to be replaced on the pattern.</li></ul></li><li><code>wenet_math(Result,Expr)</code>
This predicate evaluates an arithmetical expression. You can read more about the arithmetical expressions
<a href="https://www.swi-prolog.org/pldoc/man?section=functions" target="_blank" rel="noopener noreferrer">here</a>. For example: <code>wenet_format(4,2+2)</code><ul><li><code>Result</code>  <em>Output</em>  number with the result of the arithmetical expression.</li><li><code>Expr</code>  <em>Input</em>  mathematical expression to evaluate.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="profile-manager"></a>Profile manager<a class="hash-link" href="#profile-manager" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the profile manager component.</p><ul><li><code>wenet_profile_manager_api_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the profile manager.
For example if <code>ProfileId = &#x27;2&#x27;</code> and the URL of the profile manager API is
<strong><a href="https://wenet.u-hopper.com/prod/profile_manager" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/profile_manager</a></strong> then <code>wenet_profile_manager_api_url_to(Url,[&#x27;/profiles/&#x27;,ProfileId])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/profile_manager/profiles/2&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the profile manager.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_profile_manager_get_profile(Profile,Id)</code>
This predicate is used to obtain a profile.<ul><li><code>Profile</code>  <em>Output</em>  JSON model with the obtained profile.</li><li><code>Id </code>  <em>Input</em>  string with the identifier of the profile to obtain.</li></ul></li><li><code>wenet_profile_manager_get_community(Community,Id)</code>
This predicate is used to obtain a community.<ul><li><code>Profile</code>  <em>Output</em>  JSON model with the obtained community.</li><li><code>Id </code>  <em>Input</em>  string with the identifier of the community to obtain.</li></ul></li><li><code>wenet_id_of_profile(Id, Profile)</code>
This predicate obtains the identifier of a profile.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the profile.</li><li><code>Profile</code>  <em>Input</em>  JSON model of the profile to obtain the identifier.</li></ul></li><li><code>wenet_id_of_community(Id, Community)</code>
This predicate obtains the identifier of a community.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the community.</li><li><code>Community</code>  <em>Input</em>  JSON model of the community to obtain the identifier.</li></ul></li><li><code>wenet_profile_manager_get_social_network_relationships_page(Page,AppId,SourceId,TargetId,Type,WeightFrom,WeightTo,Order,Offset,Limit)</code>
This predicate searches for some social network relationships.<ul><li><code>Page</code>  <em>Output</em>  JSON model with the relationships that match the query parameters.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier for the relationships to return.</li><li><code>SourceId</code>  <em>Input</em>  string with the user identifier that is the source of the relationships to return.</li><li><code>TargetId</code>  <em>Input</em>  string with the user identifier that is the target of the relationships to return.</li><li><code>Type</code>  <em>Input</em>  string the type of the relationships to return.</li><li><code>WeightFrom</code>  <em>Input</em>  number minimum, inclusive, weight of the relationships to return.</li><li><code>WeightTo</code>  <em>Input</em>  number maximum, inclusive, weight of the relationships to return.</li><li><code>Order</code>  <em>Input</em>  string with the order to return the relationships.</li><li><code>Offset</code>  <em>Input</em>  number with the index of the first relationship to return.</li><li><code>Limit</code>  <em>Input</em>  number with the maximum relationships to return.</li></ul></li><li><code>wenet_relationships_of_page(Relationships,Page)</code>
This predicate returns the relationships defined on a page.<ul><li><code>Relationships</code>  <em>Output</em>  array of JSON models with the relationships defined on the page.</li><li><code>Page</code>  <em>Input</em>  JSON model with the relationships to get.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="task-manager"></a>Task manager<a class="hash-link" href="#task-manager" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the task manager component.</p><ul><li><code>wenet_task_manager_api_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the task manager.
For example if <code>TaskId = &#x27;2&#x27;</code> and the URL of the task manager API is
<strong><a href="https://wenet.u-hopper.com/prod/task_manager" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/task_manager</a></strong> then <code>wenet_task_manager_api_url_to(Url,[&#x27;/tasks/&#x27;,TaskId])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/task_manager/tasks/2&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the task manager.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_task_manager_get_task(Task,Id)</code>
This predicate is used to obtain a task.<ul><li><code>Task</code>  <em>Output</em>  JSON model with the obtained task.</li><li><code>Id </code>  <em>Input</em>  string with the identifier of the task to obtain.</li></ul></li><li><code>wenet_task_manager_merge_task(MergedTask,TaskId,Task)</code>
This predicate modifies a task model.<ul><li><code>MergedTask</code>  <em>Output</em>  JSON model with the updated task.</li><li><code>TaskId</code>  <em>Input</em>  string with the identifier of the task to modify.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to merge with the current one.</li></ul></li><li><code>wenet_task_manager_add_transaction_into_task(AddedTaskTransaction,TaskId,Transaction)</code>
This predicate is used to add a transaction into a task.<ul><li><code>AddedTaskTransaction</code>  <em>Output</em>  JSON model with the added transaction.</li><li><code>TaskId</code>  <em>Input</em>  string with the identifier of the task to add the transaction.</li><li><code>Transaction</code>  <em>Output</em>  JSON model of the transaction to add.</li></ul></li><li><code>wenet_task_manager_add_message_into_transaction(AddedTransactionMessage,TaskId,TransactionId,Message)</code>
This predicate is used to add a message into a transaction of a task.<ul><li><code>AddedTransactionMessage</code>  <em>Output</em>  JSON model with the added message.</li><li><code>TaskId</code>  <em>Input</em>  string with the identifier of the task where is the transaction.</li><li><code>TransactionId</code>  <em>Input</em>  string with the identifier of the transaction to add the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message to add into the transaction.</li></ul></li><li><code>wenet_id_of_task(Id, Task)</code>
This predicate obtains the identifier of a task.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the task.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the identifier.</li></ul></li><li><code>wenet_task_type_id_of_task(Id, Task)</code>
This predicate obtains the task type identifier of a task.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the task type.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the task type identifier.</li></ul></li><li><code>wenet_app_id_of_task(Id, Task)</code>
This predicate obtains the application identifier of a task.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the application.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the application identifier.</li></ul></li><li><code>wenet_community_id_of_task(Id, Task)</code>
This predicate obtains the community identifier of a task.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the community.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the community identifier.</li></ul></li><li><code>wenet_requester_id_of_task(Id, Task)</code>
This predicate obtains the requester identifier of a task.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the requester.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the requester identifier.</li></ul></li><li><code>wenet_goal_of_task(Goal, Task)</code>
This predicate obtains the goal of a task.<ul><li><code>Goal</code>  <em>Output</em>  JSON model with the task goal.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the goal.</li></ul></li><li><code>wenet_goal_name_of_task(GoalName, Task)</code>
This predicate obtains the goal name of a task.<ul><li><code>GoalName</code>  <em>Output</em>  string with the task goal name.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the goal name.</li></ul></li><li><code>wenet_goal_description_of_task(GoalDescription, Task)</code>
This predicate obtains the goal description of a task.<ul><li><code>GoalDescription</code>  <em>Output</em>  string with the task goal description.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the goal description.</li></ul></li><li><code>wenet_goal_keywords_of_task(GoalKeywords, Task)</code>
This predicate obtains the goal keywords of a task.<ul><li><code>GoalKeywords</code>  <em>Output</em>  array of strings with the task goal keywords.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the goal keywords.</li></ul></li><li><code>wenet_is_closed_task(Task)</code>
This predicate is <strong>true</strong> if the task is closed.<ul><li><code>Task</code>  <em>Input</em>  JSON model of the task to check if it is closed.</li></ul></li><li><code>wenet_close_ts_of_task(CloseTs, Task)</code>
This predicate obtains the time-stamp when the task is closed.<ul><li><code>CloseTs</code>  <em>Output</em>  integer with the difference, in seconds, between the time when the task is closed
and midnight, January 1, 1970, UTC.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the close time-stamp.</li></ul></li><li><code>wenet_attributes_of_task(Attributes, Task)</code>
This predicate obtains the attributes of a task.<ul><li><code>Attributes</code>  <em>Output</em>  JSON model with the task attributes.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the attributes.</li></ul></li><li><code>wenet_transactions_of_task(Transactions, Task)</code>
This predicate obtains the transaction of a task.<ul><li><code>Transactions</code>  <em>Output</em>  array of JSON models with the task transactions.</li><li><code>Task</code>  <em>Input</em>  JSON model of the task to obtain the transactions.</li></ul></li><li><code>wenet_id_of_transaction(Id, Transaction)</code>
This predicate obtains the identifier of a transaction.<ul><li><code>Id</code>  <em>Output</em>  string with the transaction identifier.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the identifier.</li></ul></li><li><code>wenet_task_id_of_transaction(TaskId, Transaction)</code>
This predicate obtains the task identifier of a transaction.<ul><li><code>TaskId</code>  <em>Output</em>  string with the task identifier.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the task identifier.</li></ul></li><li><code>wenet_label_of_transaction(Label, Transaction)</code>
This predicate obtains the label of a transaction.<ul><li><code>Label</code>  <em>Output</em>  string with the transaction label.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the label.</li></ul></li><li><code>wenet_attributes_of_transaction(Attributes, Transaction)</code>
This predicate obtains the attributes of a transaction.<ul><li><code>Attributes</code>  <em>Output</em>  JSON model with the transaction attributes.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the attributes.</li></ul></li><li><code>wenet_actioneer_id_of_transaction(ActioneerId, Transaction)</code>
This predicate obtains the user that does a transaction.<ul><li><code>ActioneerId</code>  <em>Output</em>  string with the transaction actioneer. Thus, the identifier
of the user that has done the transaction.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the identifier.</li></ul></li><li><code>wenet_creation_ts_of_transaction(CreationTs, Transaction)</code>
This predicate obtains the creation timestamp of a transaction.<ul><li><code>CreationTs</code>  <em>Output</em>  integer with the transaction creation timestamp.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the timestamp.</li></ul></li><li><code>wenet_last_update_ts_of_transaction(LastUpdateTs, Transaction)</code>
This predicate obtains the last update timestamp of a transaction.<ul><li><code>LastUpdateTs</code>  <em>Output</em>  onteger with the transaction last update timestamp.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the timestamp.</li></ul></li><li><code>wenet_messages_of_transaction(Messages, Transaction)</code>
This predicate obtains the messages of a transaction.<ul><li><code>Messages</code>  <em>Output</em>  array of JSON models with the transaction messages.</li><li><code>Transaction</code>  <em>Input</em>  JSON model of the transaction to obtain the messages.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="interaction-protocol-engine"></a>Interaction protocol engine<a class="hash-link" href="#interaction-protocol-engine" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the interaction protocol engine component.</p><ul><li><code>wenet_interaction_protocol_engine_api_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the interaction protocol engine.
For example if <code>UserId = &#x27;2&#x27;</code> and the URL of the interaction protocol engine API is
<strong><a href="https://wenet.u-hopper.com/prod/interaction_protocol_engine" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/interaction_protocol_engine</a></strong> then
<code>wenet_interaction_protocol_engine_api_url_to(Url,[&#x27;/states/users/&#x27;,UserId])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/interaction_protocol_engine/states/users/2&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the interaction protocol engine.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_interaction_protocol_engine_send_message(Sent,Message)</code>
This predicate is used to send a message to the interaction protocol engine of another user.<ul><li><code>Sent</code>  <em>Output</em>  JSON model with the sent message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message to send.</li></ul></li><li><code>wenet_interaction_protocol_engine_get_task_user_state(State,TaskId,UserId)</code>
This predicate is used to obtain the state of a user in a task.<ul><li><code>State</code>  <em>Output</em>  JSON model with the state of the user on the task.</li><li><code>TaskId</code>  <em>Input</em>  string identifier of the task to get the state.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to get the state.</li></ul></li><li><code>wenet_interaction_protocol_engine_merge_task_user_state(MergedState,TaskId,UserId,NewState)</code>
This predicate is used to change the state of a user in a task.<ul><li><code>MergedState</code>  <em>Output</em>  JSON model with the modified state of the user on the task.</li><li><code>TaskId</code>  <em>Input</em>  string identifier of the task to modify the state.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to modify the state.</li><li><code>NewState</code>  <em>Input</em>  JSON model with the new values for the state.</li></ul></li><li><code>wenet_interaction_protocol_engine_get_community_user_state(State,CommunityId,UserId)</code>
This predicate is used to obtain the state of a user in a community.<ul><li><code>State</code>  <em>Output</em>  JSON model with the state of the user on the community.</li><li><code>CommunityId</code>  <em>Input</em>  string identifier of the community to get the state.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to get the state.</li></ul></li><li><code>wenet_interaction_protocol_engine_merge_community_user_state(MergedState,CommunityId,UserId,NewState)</code>
This predicate is used to change the state of a user in a community.<ul><li><code>MergedState</code>  <em>Output</em>  JSON model with the modified state of the user on the community.</li><li><code>CommunityId</code>  <em>Input</em>  string identifier of the community to modify the state.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to modify the state.</li><li><code>NewState</code>  <em>Input</em>  JSON model with the new values for the state.</li></ul></li><li><code>wenet_interaction_protocol_engine_get_user_state(State,UserId)</code>
This predicate is used to obtain the state of a user.<ul><li><code>State</code>  <em>Output</em>  JSON model with the state of the user.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to get the state.</li></ul></li><li><code>wenet_interaction_protocol_engine_merge_user_state(MergedState,UserId,NewState)</code>
This predicate is used to change the state of a user.<ul><li><code>MergedState</code>  <em>Output</em>  JSON model with the modified state of the user.</li><li><code>UserId</code>  <em>Input</em>  string identifier of the user to modify the state.</li><li><code>NewState</code>  <em>Input</em>  JSON model with the new values for the state.</li></ul></li><li><code>wenet_app_id_of_protocol_message(AppId, Message)</code>
This predicate is used to obtain the identifier of the application of a message.<ul><li><code>AppId</code>  <em>Output</em>  string with the application identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_community_id_of_protocol_message(CommunityId, Message)</code>
This predicate is used to obtain the identifier of the community of a message.<ul><li><code>CommunityId</code>  <em>Output</em>  string with the community identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_task_id_of_protocol_message(TaskId, Message)</code>
This predicate is used to obtain the identifier of the task of a message.<ul><li><code>TaskId</code>  <em>Output</em>  string with the task identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_transaction_id_of_protocol_message(TransactionId, Message)</code>
This predicate is used to obtain the identifier of the transaction of a message.<ul><li><code>TransactionId</code>  <em>Output</em>  string with the transaction identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_sender_of_protocol_message(Sender, Message)</code>
This predicate is used to obtain the sender of a message.<ul><li><code>SenderComponent</code>  <em>Output</em>  JSON model with the sender of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_sender_component_of_protocol_message(SenderComponent, Message)</code>
This predicate is used to obtain the sender component of a message.<ul><li><code>SenderComponent</code>  <em>Output</em>  string with the sender component of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_sender_id_of_protocol_message(SenderId, Message)</code>
This predicate is used to obtain the sender identifier of a message.<ul><li><code>SenderId</code>  <em>Output</em>  string with the sender identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_receiver_of_protocol_message(Receiver, Message)</code>
This predicate is used to obtain the receiver of a message.<ul><li><code>ReceiverComponent</code>  <em>Output</em>  JSON model with the receiver of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_receiver_component_of_protocol_message(ReceiverComponent, Message)</code>
This predicate is used to obtain the receiver component of a message.<ul><li><code>ReceiverComponent</code>  <em>Output</em>  string with the receiver component of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_receiver_id_of_protocol_message(ReceiverId, Message)</code>
This predicate is used to obtain the receiver identifier of a message.<ul><li><code>ReceiverId</code>  <em>Output</em>  string with the receiver identifier of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_particle_of_protocol_message(Particle, Message)</code>
This predicate is used to obtain the particle of a message.<ul><li><code>Particle</code>  <em>Output</em>  string with the particle of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_content_of_protocol_message(Content, Message)</code>
This predicate is used to obtain the content of a message.<ul><li><code>Content</code>  <em>Output</em>  JSON model with the content of the message.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message.</li></ul></li><li><code>wenet_new_protocol_message(Message,AppId,CommunityId,TaskId,TransactionId,SenderComponent,SenderUserId,ReceiverComponent,ReceiverUserId,Particle,Content)</code>
This predicate is used to create a protocol message.<ul><li><code>Message</code>  <em>Output</em>  JSON model with the created protocol message.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier for the message.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier for the message.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier for the message.</li><li><code>TransactionId</code>  <em>Input</em>  string with the transaction identifier for the message.</li><li><code>SenderComponent</code>  <em>Input</em>  string with the component for the message sender.</li><li><code>SenderUserId</code>  <em>Input</em>  string with the identifier for the message sender.</li><li><code>ReceiverComponent</code>  <em>Input</em>  string with the component for the message receiver.</li><li><code>ReceiverUserId</code>  <em>Input</em>  string with the identifier for the message receiver.</li><li><code>Particle</code>  <em>Input</em>  string with the particle for the message.</li><li><code>Content</code>  <em>Input</em>  JSON model with the content for the message.</li></ul></li><li><code>wenet_interaction_protocol_engine_send_event(Sent,Event)</code>
This predicate is used to send an event.<ul><li><code>Sent</code>  <em>Output</em>  JSON model with the sent event.</li><li><code>Event</code>  <em>Input</em>  JSON model with the event to send.</li></ul></li><li><code>wenet_interaction_protocol_engine_delete_event(Id)</code>
This predicate is used to cancel the send on an event.<ul><li><code>Id</code>  <em>Input</em>  string with the identifier of the event to delete.</li></ul></li><li><code>wenet_id_of_protocol_event(Id, Event)</code>
This predicate is used to obtain the identifier of an event.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the event.</li><li><code>Event</code>  <em>Input</em>  JSON model with the event.</li></ul></li><li><code>wenet_new_protocol_event(Event,AppId,CommunityId,TaskId,TransactionId,UserId,Delay,Particle,Content)</code>
This predicate is used to create a protocol event.<ul><li><code>Event</code>  <em>Output</em>  JSON model with the created protocol event.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier for the event.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier for the event.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier for the event.</li><li><code>TransactionId</code>  <em>Input</em>  string with the transaction identifier for the event.</li><li><code>UserId</code>  <em>Input</em>  string with the component for the event sender.</li><li><code>Delay</code>  <em>Input</em>  number with the seconds to wait before sending the event.</li><li><code>Particle</code>  <em>Input</em>  string with the particle for the event.</li><li><code>Content</code>  <em>Input</em>  JSON model with the content for the event.</li></ul></li><li><code>wenet_new_interaction(Interaction,AppId,CommunityId,TaskTypeId,TaskId,SenderId,ReceiverId,TransactionLabel,TransactionAttributes,TransactionTs,MessageLabel,MessageAttributes,MessageTs)</code>
This predicate is used to create a new interaction.<ul><li><code>Interaction</code>  <em>Output</em>  JSON model with the created interaction.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier for the interaction.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier for the interaction.</li><li><code>TaskTypeId</code>  <em>Input</em>  string with the task type identifier for the interaction.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier for the interaction.</li><li><code>SenderId</code>  <em>Input</em>  string with the identifier of the user that starts the interaction.</li><li><code>ReceiverId</code>  <em>Input</em>  string withthe identifier of the user that ends the interaction.</li><li><code>TransactionLabel</code>  <em>Input</em>  string with the label of the transaction that has started the interaction.</li><li><code>TransactionAttributes</code>  <em>Input</em>  JSON with the attributes of the transaction that has started the interaction.</li><li><code>TransactionTs</code>  <em>Input</em>  integer with the UTC epoch timestamp representing the time when the transaction has been done.</li><li><code>MessageLabel</code>  <em>Input</em>  string with the label of the message that has started the interaction.</li><li><code>MessageAttributes</code>  <em>Input</em>  JSON with the attributes of the message that has started the interaction.</li><li><code>MessageTs</code>  <em>Input</em>  integer with the UTC epoch timestamp representing the time when the message has been done.</li></ul></li><li><code>wenet_interaction_protocol_engine_add_interaction(Interaction)</code>
This predicate is used to add a new interaction.<ul><li><code>Interaction</code>  <em>Input</em>  JSON model with the interaction to add.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="service"></a>Service<a class="hash-link" href="#service" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the service component.</p><ul><li><code>wenet_service_api_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the service.
For example if <code>AppId = &#x27;2&#x27;</code> and the URL of the service API is
<strong><a href="https://wenet.u-hopper.com/prod/service" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/service</a></strong> then <code>wenet_service_api_url_to(Url,[&#x27;/app/&#x27;,AppId])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/service/app/2&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the service.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_service_manager_get_app(App,Id)</code>
This predicate is used to obtain an application.<ul><li><code>App</code>  <em>Output</em>  JSON model with the obtained application data.</li><li><code>Id </code>  <em>Input</em>  string with the identifier of the application to obtain.</li></ul></li><li><code>wenet_id_of_app(Id, App)</code>
This predicate obtains the identifier of an application.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the application.</li><li><code>App</code>  <em>Input</em>  JSON model of the application to obtain the identifier.</li></ul></li><li><code>wenet_message_callback_url_of_app(Url, App)</code>
This predicate obtains the URL to post the callback messages of an application.<ul><li><code>Url</code>  <em>Output</em>  string with the URL to post the callback messages.</li><li><code>App</code>  <em>Input</em>  JSON model of the application to obtain the callback URL.</li></ul></li><li><code>wenet_service_get_app_users(Users,Id)</code>
This predicate is used to obtain the users that are in an application.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of users defined in the application.</li><li><code>Id</code>  <em>Input</em>  string with the identifier of the application to obtain the users.</li></ul></li><li><code>wenet_service_get_app_users(Users,App)</code>
This predicate is used to obtain the users that are in an application.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the identifiers of users defined in the application.</li><li><code>App</code>  <em>Input</em>  JSON model with the application model.</li></ul></li><li><code>wenet_new_message(Callback,AppId,ReceiverId,Label,Attributes)</code>
This predicate is used to create a callback message to send to an application.<ul><li><code>Callback</code>  <em>Output</em>  JSON model of strings with the identifiers of users defined in the application.</li><li><code>AppId</code>  <em>Input</em>  string with the identifier of the application to post the message.</li><li><code>ReceiverId</code>  <em>Input</em>  string with the user identifier to post the message.</li><li><code>Label</code>  <em>Input</em>  string with the label of the message.</li><li><code>Attributes</code>  <em>Input</em>  JSON model with the attributes of the message.</li></ul></li><li><code>wenet_app_id_of_message(Id, Message)</code>
This predicate obtains the application identifier of a message.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the application.</li><li><code>Task</code>  <em>Input</em>  JSON model of the message to obtain the application identifier.</li></ul></li><li><code>wenet_receiver_id_of_message(Id, Message)</code>
This predicate obtains the receiver identifier of a message.<ul><li><code>Id</code>  <em>Output</em>  string with the identifier of the receiver.</li><li><code>Task</code>  <em>Input</em>  JSON model of the message to obtain the receiver identifier.</li></ul></li><li><code>wenet_label_of_message(Label, Message)</code>
This predicate obtains the label of a message.<ul><li><code>Label</code>  <em>Output</em>  string with the label.</li><li><code>Task</code>  <em>Input</em>  JSON model of the message to obtain the label.</li></ul></li><li><code>wenet_attributes_of_message(Attributes, Message)</code>
This predicate obtains the attributes of a message.<ul><li><code>Attributes</code>  <em>Output</em>  JSON model with the attributes.</li><li><code>Task</code>  <em>Input</em>  JSON model of the message to obtain the attributes.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="incentive-server"></a>Incentive server<a class="hash-link" href="#incentive-server" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the incentive server component.</p><ul><li><code>wenet_incentive_server_api_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the incentive server.
For example if the URL of the incentive server API is
<strong><a href="https://wenet.u-hopper.com/prod/incentive_server" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/incentive_server</a></strong> then <code>wenet_incentive_server_api_url_to(Url,[&#x27;/Tasks/TaskStatus/&#x27;])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/incentive_server/Tasks/TaskStatus/&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the incentive server.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_incentive_server_update_task_transaction_status(Updated,Status)</code>
This predicate is used to update the transaction status.<ul><li><code>Updated</code>  <em>Output</em>  JSON model with the updated status.</li><li><code>Status</code>  <em>Input</em>  JSON model with the transaction status to update.</li></ul></li><li><code>wenet_incentive_server_update_task_transaction_status(Status,UserId,CommunityId,AppId,TaskTypeId,Label,Count)</code>
This predicate is used to create the transaction status.<ul><li><code>Status</code>  <em>Output</em>  JSON model with the status.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier of the status.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier of the status.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier of the status.</li><li><code>TaskTypeId</code>  <em>Input</em>  string with the task type identifier of the status.</li><li><code>Label</code>  <em>Input</em>  string with the label of the done transaction.</li><li><code>Count</code>  <em>Input</em>  integer with the times the transaction is done by the user, for the task type in the community.</li></ul></li><li><code>wenet_incentive_server_update_task_type_status(Updated,Status)</code>
This predicate is used to update the task type status.<ul><li><code>Updated</code>  <em>Output</em>  JSON model with the updated status.</li><li><code>Status</code>  <em>Input</em>  JSON model with the transaction status to update.</li></ul></li><li><code>wenet_new_task_type_status(Status,UserId,CommunityId,AppId,TaskTypeId,Count)</code>
This predicate is used to create the task type status.<ul><li><code>Status</code>  <em>Output</em>  JSON model with the status.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier of the status.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier of the status.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier of the status.</li><li><code>TaskTypeId</code>  <em>Input</em>  string with the task type identifier of the status.</li><li><code>Count</code>  <em>Input</em>  integer with the times a task for the task type is created by the user in the community.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="social-context-builder"></a>Social context builder<a class="hash-link" href="#social-context-builder" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the social context builder component.</p><ul><li><code>wenet_social_context_builder_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the social context builder.
For example if the URL of the social context builder API is
<strong><a href="https://wenet.u-hopper.com/prod/social_context_builder" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/social_context_builder</a></strong> , <code>UserId = &#x27;2&#x27;</code> and <code>TaskId = &#x27;1&#x27;</code>
then <code>wenet_social_context_builder_url_to(Url,[&#x27;/social/explanations/&#x27;,UserId,&#x27;/&#x27;,TaskId,&#x27;/&#x27;])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/social_context_builder/social/explanations/2/1&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the social context builder.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_social_context_builder_post_preferences(Ranking,UserId,TaskId,Users)</code>
Post the preferences of a user. This is used to calculate the ranking of the volunteers.<ul><li><code>Ranking</code>  <em>Output</em>  array of string with the rabked user identifier.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier.</li><li><code>Users</code>  <em>Input</em>  array of string with the identifiers of the preferred users.</li></ul></li><li><code>wenet_social_context_builder_retrieve_social_explanation(SocialExplanation,UserId,TaskId)</code>
This predicate is used to get the social explanation to choose a user.<ul><li><code>SocialExplanation</code>  <em>Output</em>  JSON model with the social explanation.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier.</li></ul></li><li><code>wenet_description_of_social_explanation(Description, SocialExplanation)</code>
This predicate is used to get the description of the social explanation.<ul><li><code>Description</code>  <em>Output</em>  string with the description of the explanation.</li><li><code>SocialExplanation</code>  <em>Input</em>  JSON model with the social explanation.</li></ul></li><li><code>wenet_summary_of_social_explanation(Summary, SocialExplanation)</code>
This predicate is used to get the summary of the social explanation.<ul><li><code>Summary</code>  <em>Output</em>  string with the summary of the explanation.</li><li><code>SocialExplanation</code>  <em>Input</em>  JSON model with the social explanation.</li></ul></li><li><code>wenet_social_context_builder_post_preferences_answers(Ranking,UserId,TaskId,UserAnswers)</code>
Post the preferences answers of a user. This is used to calculate the ranking of the answers.<ul><li><code>Ranking</code>  <em>Output</em>  array of JSON models with the ranked user answers.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier.</li><li><code>UserAnswers</code>  <em>Input</em>  array of Json models sith the user and answers to rank.</li></ul></li><li><code>wenet_social_context_builder_put_preferences_answers_update(UserId,TaskId,Selected,Ranking)</code>
This predicate is used to create a user message that can be used to notify about the interaction between users.<ul><li><code>UserId</code>  <em>Input</em>  string with the user that has selected teh answer.</li><li><code>TaskId</code>  <em>Input</em>  string with the identifier of the task where the answer is selected.</li><li><code>Selected</code>  <em>Input</em>  integer with the index of the selected answer of the ranking. It starts with 0.</li><li><code>Ranking</code>  <em>Input</em>  array of JSON models with the ranked user answers where is the selected one.</li></ul></li><li><code>wenet_user_id_of_user_answer(UserId, UserAnswer)</code>
This predicate is used to get the user identifier of a user answer.<ul><li><code>UserId</code>  <em>Output</em>  string with the user identifier.</li><li><code>UserAnswer</code>  <em>Input</em>  JSON model with the user answer.</li></ul></li><li><code>wenet_answer_of_user_answer(Answer, UserAnswer)</code>
This predicate is used to get the answer of a user answer.<ul><li><code>Answer</code>  <em>Output</em>  string with the answer.</li><li><code>UserAnswer</code>  <em>Input</em>  JSON model with the user answer.</li></ul></li><li><code>wenet_new_user_answer(UserAnswer, UserId, Answer)</code>
This predicate is used to create a new user answer.<ul><li><code>UserAnswer</code>  <em>Output</em>  JSON model with the user answer.</li><li><code>UserId</code>  <em>Input</em>  string model with the user identifier.</li><li><code>Answer</code>  <em>Input</em>  string with the answer.</li></ul></li><li><code>wenet_social_context_builder_post_social_notification(Message)</code>
This predicate is used to notify the social context builder about an interaction between users.<ul><li><code>Message</code>  <em>Input</em>  JSON model with the interaction message between users.</li></ul></li><li><code>wenet_new_user_message(UserAnswer, UserId, Answer)</code>
This predicate is used to create a user message that can be used to notify about the interaction between users.<ul><li><code>UserMessage</code>  <em>Output</em>  JSON model with the interaction message between the users.</li><li><code>TaskId</code>  <em>Input</em>  string with the identifier of the task where the interaciton is done.</li><li><code>TransactionId</code>  <em>Input</em>  string with the identifier of the task transaction.</li><li><code>Timestamp</code>  <em>Input</em>  number with the UTC epoch timestamp when the interaction is done.</li><li><code>SenderId</code>  <em>Input</em>  string with the identifier of the user that started the interaction.</li><li><code>Message</code>  <em>Input</em>  JSON model with the message that is sent to the user.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="personal-context-builder"></a>Personal context builder<a class="hash-link" href="#personal-context-builder" title="Direct link to heading">#</a></h3><p>The next predicates are used to interact with the personal context builder component.</p><ul><li><code>wenet_personal_context_builder_url_to(Url,Paths)</code>
This predicate is used to obtain the URL to interact with the API of the personal context builder.
For example if the URL of the personal context builder API is
<strong><a href="https://wenet.u-hopper.com/prod/personal_context_builder" target="_blank" rel="noopener noreferrer">https://wenet.u-hopper.com/prod/personal_context_builder</a></strong> , <code>Latitude = 0.2</code> , <code>Longitude = 0.1</code>
and <code>NumUsers = 4</code>
then <code>wenet_personal_context_builder_url_to(Url,[&#x27;/closest/?latitude=&#x27;,Latitude,&#x27;&amp;longitude=&#x27;,Longitude,&#x27;&amp;nb_user_max=&#x27;,NumUsers])</code>
will produce <code>URL = &#x27;https://wenet.u-hopper.com/prod/personal_context_builder/closest/?latitude=0.2&amp;longitude=0.1&amp;nb_user_max=4&#x27;</code>.<ul><li><code>Url</code>  <em>Output</em>  string of the API point to the personal context builder.</li><li><code>Paths</code>  <em>Input</em>  array of values used to build the API point.</li></ul></li><li><code>wenet_personal_context_builder_locations(Locations,Users)</code>
This predicate is used to obtain the locations of a set of users.<ul><li><code>Locations</code>  <em>Output</em>  array of JSON models with the locations of the users.</li><li><code>Users</code>  <em>Input</em>  array of strings with the identifiers of the users to get the locations.</li></ul></li><li><code>wenet_user_id_of_location(UserId,Location)</code>
This predicate is used to obtain the user identifier of a location.<ul><li><code>UserId</code>  <em>Output</em>  string with the user identifier of the location.</li><li><code>Location</code>  <em>Input</em>  JSON model with the location to get the user identifier.</li></ul></li><li><code>wenet_users_of_locations(Users,Locations)</code>
This predicate is used to obtain the user identifiers of some locations.<ul><li><code>Users</code>  <em>Output</em>  array of strings with the user identifiers of the locations.</li><li><code>Locations</code>  <em>Input</em>  array of JSON model with the locations to get the user identifiers.</li></ul></li><li><code>wenet_longitude_of_location(Longitude,Locations)</code>
This predicate is used to obtain the longitude of a location.<ul><li><code>Longitude</code>  <em>Output</em>  number with the longitude of the location.</li><li><code>Location</code>  <em>Input</em>  JSON model with the location to get the longitude.</li></ul></li><li><code>wenet_latitude_of_location(Latitude,Locations)</code>
This predicate is used to obtain the latitude of a location.<ul><li><code>Latitude</code>  <em>Output</em>  number with the latitude of the location.</li><li><code>Location</code>  <em>Input</em>  JSON model with the location to get the latitude.</li></ul></li><li><code>wenet_personal_context_builder_closest(ClosestUsers,Latitude,Longitude,NumUsers)</code>
This predicate is used to obtain the closest users into a location.<ul><li><code>ClosestUsers</code>  <em>Output</em>  array of JSON models with the closest users into a location.</li><li><code>Latitude</code>  <em>Input</em>  number with the location latitude.</li><li><code>Longitude</code>  <em>Input</em>  number with the location longitude.</li><li><code>NumUsers</code>  <em>Input</em>  number with the number maximum users to get.</li></ul></li><li><code>wenet_user_id_of_closest(UserId,ClosestUser)</code>
This predicate is used to obtain the identifier of the user in the closest user location.<ul><li><code>UserId</code>  <em>Output</em>  string with the user identifier of the closest user.</li><li><code>ClosestUser</code>  <em>Input</em>  JSON model with the closest user.</li></ul></li><li><code>wenet_distance_of_closest(Distance,ClosestUser)</code>
This predicate is used to obtain the distance in the closest user location.<ul><li><code>Distance</code>  <em>Output</em>  number distance in meters of the closest user to the location.</li><li><code>ClosestUser</code>  <em>Input</em>  JSON model with the closest user.</li></ul></li><li><code>wenet_users_of_closest(Users,ClosestUsers)</code>
This predicate is used to obtain the user identifiers of a set of closest users.<ul><li><code>Users</code>  <em>Output</em>  array of string with the user identifier of the closest users.</li><li><code>ClosestUsers</code>  <em>Input</em>  array of JSON models with the closest users.</li></ul></li><li><code>wenet_distance_between_locations(Distance,Source,Target)</code>
This predicate is used to calculate the haversine distance between two locations.<ul><li><code>Distance</code>  <em>Output</em>  number with the distance between the locations in meters.</li><li><code>Source</code>  <em>Input</em>  JSON model with the location as source to calculate the distance.</li><li><code>Target</code>  <em>Input</em>  JSON model with the location as target to calculate the distance.</li></ul></li><li><code>wenet_distance_between_locations(Distance,SourceLatitude,SourceLongitude,TargetLatitude,TargetLongitude)</code>
This predicate is used to calculate the haversine distance between two locations.<ul><li><code>Distance</code>  <em>Output</em>  number with the distance between the locations in meters.</li><li><code>SourceLatitude</code>  <em>Input</em>  number with the source latitude to calculate the distance.</li><li><code>SourceLongitude</code>  <em>Input</em>  number with the source longitude to calculate the distance.</li><li><code>TargetLatitude</code>  <em>Input</em>  number with the target latitude to calculate the distance.</li><li><code>TargetLongitude</code>  <em>Input</em>  number with the target longitude to calculate the distance.</li></ul></li><li><code>wenet_filter_locations_by_distance(Filtered,Source,Locations,Min,Max)</code>
This predicate filters a set of locations if they are on a range to another location.<ul><li><code>Filtered</code>  <em>Output</em>  array of JSON models with the locations that are in the range distance.</li><li><code>Source</code>  <em>Input</em>  JSON model with the location to calculate the distance to.</li><li><code>Locations</code>  <em>Input</em>  array of JSON models with the locations to filter.</li><li><code>Min</code>  <em>Input</em>  number with the minimum distance in meters to the source location. The distance is inclusive.</li><li><code>Max</code>  <em>Input</em>  number with the maximum distance in meters to the source location. The distance is inclusive.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="deprecated-predicates"></a>Deprecated predicates<a class="hash-link" href="#deprecated-predicates" title="Direct link to heading">#</a></h2><p>The  predicates of this section are only for backward compatibility, but you should avoid
to use them.</p><ul><li><p><code>notify_incentive_server(Action,Message)</code>
This action notifies the incentive server about a change of the task.
This function is no more available on the incentive server API. So nothings do.</p><ul><li><code>Action</code>  <em>Input</em>  string with the action that has changed the task.</li><li><code>Message</code>  <em>Input</em>  string that explains the change.</li></ul></li><li><p><code>wenet_incentive_server_update_task_status(Updated,Status)</code>
This predicate is used to update the task status.
This function is no more available on the incentive server API. So nothings do.</p><ul><li><code>Updated</code>  <em>Output</em>  JSON model with the updated status.</li><li><code>Status</code>  <em>Input</em>  JSON model with the task status to update.</li></ul></li><li><p><code>wenet_new_task_status(Status,AppId,UserId,CommunityId,TaskId,Action,Message)</code>
This predicate is used to create the task status.
This data model is no more used.</p><ul><li><code>Status</code>  <em>Output</em>  JSON model with the status.</li><li><code>AppId</code>  <em>Input</em>  string with the application identifier of the status.</li><li><code>UserId</code>  <em>Input</em>  string with the user identifier of the status.</li><li><code>CommunityId</code>  <em>Input</em>  string with the community identifier of the status.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier of the status.</li><li><code>Action</code>  <em>Input</em>  string with the action of the status.</li><li><code>Message</code>  <em>Input</em>  string with the message of the status.</li></ul></li><li><p><code>wenet_social_context_builder_update_preferences(UserId,TaskId,Users)</code>
This predicate is deprecated use wenet_social_context_builder_post_preferences instead.</p><ul><li><code>UserId</code>  <em>Input</em>  string with the user identifier.</li><li><code>TaskId</code>  <em>Input</em>  string with the task identifier.</li><li><code>Users</code>  <em>Input</em>  array of string with the identifiers of the preferred users.</li></ul></li><li><p><code>notify_volunteers_to_social_context_builder(Volunteers,UserId)</code>
This predicate is deprecated use volunteers_ranking instead.</p><ul><li><code>Volunteers</code>  <em>Input</em>  array of strings with the user identifiers that has volunteer to do a task.</li><li><code>UserId</code>  <em>Input</em>  string user identifier to be a volunteer.</li></ul></li><li><p><code>wenet_relationships_of_profile(Relationships,Profile)</code>
The profile does not have mpore relationships use get_relationships instead.</p><ul><li><code>Relationships</code>  <em>Output</em>  array of JSON models with the relationships of the profile.</li><li><code>Profile</code> <em>Input</em>  JSON model to get the relationships.</li></ul></li><li><p><code>wenet_user_id_of_relationship(UserId, Relationship)</code>
The relationship define new fields and teh userId is changes to targetId.
Use wenet_target_id_of_relationship instead.</p><ul><li><code>UserId</code>  <em>Output</em>  string eith the user identifier of the relationship.</li><li><code>Relationship</code>  <em>Input</em>  JSON model to get the user identifier.</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/tech/conversation/norms.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated on <b><time datetime="2022-02-25T11:17:36.000Z">2/25/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/developer/docs/tech/conversation/app-logic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« App logic</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/developer/docs/tech/conversation/models"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Models Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#protocol-actions" class="table-of-contents__link">Protocol actions</a><ul><li><a href="#create-a-task" class="table-of-contents__link">Create a task</a></li><li><a href="#do-a-task-transaction" class="table-of-contents__link">Do a task transaction</a></li><li><a href="#send-an-incentive" class="table-of-contents__link">Send an incentive</a></li><li><a href="#received-message" class="table-of-contents__link">Received message</a></li><li><a href="#received-event" class="table-of-contents__link">Received event</a></li></ul></li><li><a href="#conditions" class="table-of-contents__link">Conditions</a><ul><li><a href="#message-conditions" class="table-of-contents__link">Message conditions</a></li><li><a href="#users-conditions" class="table-of-contents__link">Users conditions</a></li><li><a href="#me-conditions" class="table-of-contents__link">Me conditions</a></li><li><a href="#application-conditions" class="table-of-contents__link">Application conditions</a></li><li><a href="#community-conditions" class="table-of-contents__link">Community conditions</a></li><li><a href="#task-conditions" class="table-of-contents__link">Task conditions</a></li><li><a href="#social-context-builder-conditions" class="table-of-contents__link">Social context builder conditions</a></li><li><a href="#personal-context-builder-conditions" class="table-of-contents__link">Personal context builder conditions</a></li><li><a href="#diversity-conditions" class="table-of-contents__link">Diversity conditions</a></li><li><a href="#time-conditions" class="table-of-contents__link">Time conditions</a></li><li><a href="#json-conditions" class="table-of-contents__link">JSON conditions</a></li></ul></li><li><a href="#actions" class="table-of-contents__link">Actions</a><ul><li><a href="#user-actions" class="table-of-contents__link">User actions</a></li><li><a href="#community-actions" class="table-of-contents__link">Community actions</a></li><li><a href="#task-actions" class="table-of-contents__link">Task actions</a></li><li><a href="#interact-with-wenet-components" class="table-of-contents__link">Interact with WeNet components</a></li></ul></li><li><a href="#other-useful-norms-predicates" class="table-of-contents__link">Other Useful Norms predicates</a><ul><li><a href="#facts" class="table-of-contents__link">Facts</a></li><li><a href="#user-value-models" class="table-of-contents__link">User value models</a></li><li><a href="#logs-messages" class="table-of-contents__link">Logs messages</a></li><li><a href="#http-interaction" class="table-of-contents__link">HTTP interaction</a></li><li><a href="#utils" class="table-of-contents__link">Utils</a></li><li><a href="#profile-manager" class="table-of-contents__link">Profile manager</a></li><li><a href="#task-manager" class="table-of-contents__link">Task manager</a></li><li><a href="#interaction-protocol-engine" class="table-of-contents__link">Interaction protocol engine</a></li><li><a href="#service" class="table-of-contents__link">Service</a></li><li><a href="#incentive-server" class="table-of-contents__link">Incentive server</a></li><li><a href="#social-context-builder" class="table-of-contents__link">Social context builder</a></li><li><a href="#personal-context-builder" class="table-of-contents__link">Personal context builder</a></li></ul></li><li><a href="#deprecated-predicates" class="table-of-contents__link">Deprecated predicates</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/developer/assets/js/runtime~main.d98cc188.js"></script>
<script src="/developer/assets/js/main.b554da6f.js"></script>
</body>
</html>